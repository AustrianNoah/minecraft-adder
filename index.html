<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minecraft Bedrock – Externen Server hinzufügen</title>
  <style>
    body{font-family:sans-serif;background:#0b0d10;color:#e6edf3;display:flex;justify-content:center;align-items:center;height:100vh;margin:0}
    .card{background:#12161c;padding:24px;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.4);max-width:420px;width:100%}
    label{display:block;margin-bottom:4px;font-weight:bold}
    input{width:100%;padding:10px;border-radius:8px;border:1px solid #333;background:#1d222a;color:#fff;margin-bottom:14px}
    button{padding:12px 16px;border:none;border-radius:8px;background:#3b82f6;color:#fff;font-weight:bold;cursor:pointer;width:100%}
    .error{color:#f87171;margin-bottom:12px;display:none}
  </style>
</head>
<body>
  <div class="card">
    <h1>Bedrock-Server hinzufügen</h1>
    <form id="mc-form">
      <label for="name">Servername</label>
      <input id="name" name="name" type="text" required>

      <label for="host">IP/Hostname</label>
      <input id="host" name="host" type="text" required>

      <label for="port">Port</label>
      <input id="port" name="port" type="number" value="19132" required>

      <div id="err" class="error"></div>
      <button type="submit">Senden</button>
    </form>
  </div>

  <script>
    const form = document.getElementById("mc-form");
    const err = document.getElementById("err");

    function buildUri(name, host, port){
      return `minecraft://?addExternalServer=${encodeURIComponent(name + "|" + host + ":" + port)}`;
    }

    function redirect(name,host,port){
      window.location.href = buildUri(name,host,port);
    }

    // Direkt weiterleiten, wenn URL-Parameter vorhanden sind
    const params = new URLSearchParams(window.location.search);
    const pname = params.get("name");
    const phost = params.get("host");
    const pport = params.get("port");
    if(pname && phost && pport){
      redirect(pname.trim(), phost.trim(), pport.trim());
    }

    form.addEventListener("submit", e => {
      e.preventDefault();
      const name = form.name.value.trim();
      const host = form.host.value.trim();
      const port = form.port.value.trim();
      if(!name || !host || !port){
        err.textContent = "Bitte alle Felder ausfüllen.";
        err.style.display="block";
        return;
      }
      err.style.display="none";
      redirect(name,host,port);
    });
  </script>
</body>
</html>
